<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson13</title>
</head>
<body>
    <script>
        /*async function asyncFunction() {
            //return "hello";
        }

        asyncFunction().then((returnVal) => {console.log(returnVal)});
        */

        const prom = new Promise( resolve => {
            setTimeout( () => resolve("この値を取り出します。"), 3000)
        });

        async function asyncFunction() {
            const value = await prom;
            console.log(value);
        };

        asyncFunction();

        async function throwError() {
            try {
                await Promise.reject("Promiseが失敗しました。");
            } catch(error) {
                console.log(error);
            }
        }

        throwError();

        function promiseFactory( count ){
            return new Promise( (resolve, reject) => {
                setTimeout(() => {
                    count++;
                    console.log(`${count}回目のコールです。時刻:[${new Date().toTimeString()}]`);

                    if ( count === 3 ) {
                        reject( count );
                    } else {
                        resolve( count );
                    }
                }, 1000);
            });
        }

        async function execute(){
            try {
                let count = await promiseFactory(0);
                count = await promiseFactory(count);
                count = await promiseFactory(count);
                count = await promiseFactory(count);
            }
        }
    </script>
</body>
</html>